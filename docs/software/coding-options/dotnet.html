<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>.NET </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content=".NET ">
      
      
      <link rel="icon" href="../../images/favicon.ico">
      <link rel="stylesheet" href="../../public/docfx.min.css">
      <link rel="stylesheet" href="../../public/main.css">
      <meta name="docfx:navrel" content="../../toc.html">
      <meta name="docfx:tocrel" content="../toc.html">
      
      <meta name="docfx:rel" content="../../">
      
      
      <meta name="docfx:docurl" content="https://github.com/ghi-electronics/duelink-website/blob/duelink_v1.1.5/software/coding-options/dotnet.md/#L1">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">
  </head>

  <script type="module" src="./../../public/docfx.min.js"></script>

  <script>
    const theme = localStorage.getItem('theme') || 'auto'
    document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
  </script>


  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../../index.html">
            <img id="logo" class="svg" src="../../images/logo.png" alt="">
            
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" style="margin-top: -.65em; margin-left: -.8em" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="">
<h1 id="net">.NET</h1>

<hr>
<p><img src="../images/cSharp.png" alt=".NET C#"></p>
<p>The .NET DUE library allows full .NET programs to access physical sensors and actuators. This allows complex .NET programs to do all the heavy lifting and send only the necessary components to control devices.</p>
<p>The provided library is implemented in C# but the user can use any .NET system, such as <strong>Visual Basic</strong>.</p>
<h2 id="setup">Setup</h2>
<p>This page assumes the user is already familiar with .NET C# and there is a development machine that is already setup to build and run .NET programs. No changes are needed there but we are using Microsoft Visual Studio Code as a personal preference.</p>
<div class="TIP">
<h5>Tip</h5>
<p>If this is the first time you use your device, start by visiting the <a href="../../hardware/intro.html">Hardware</a> page and load your device with the appropriate firmware. The <a href="../console.html">Console</a> is also a great place to start.</p>
</div>
<p>Start a new project with a simple line of code to test out the project is running</p>
<div class="TIP">
<h5>Tip</h5>
<p>C# Top level statements feature is being utilized, but not required.</p>
</div>
<pre><code class="lang-csharp">Console.WriteLine(&quot;Hello, World!&quot;);
</code></pre>
<p>Download and install the latest <code>GHIElectronics.DUELink</code> library from NuGet.org. Alternatively, get it from the <a href="../downloads.html">Downloads</a> page.</p>
<h2 id="blinky">Blinky!</h2>
<p>Our first program will blink the on-board LED 20 times, where it comes on for 200ms and then it is off for 800ms.</p>
<div class="NOTE">
<h5>Note</h5>
<p>We can access which COM port our DUE enable device is connected to by calling the GetConnectionPort()</p>
</div>
<pre><code class="lang-csharp">using GHIElectronics.DUELink;
Console.WriteLine(&quot;Hello DUE!&quot;);
var availablePort = DUELinkController.GetConnectionPort();
var dev = new DUELinkController(availablePort);
dev.Led.Set(200, 800, 20);
Console.WriteLine(&quot;Bye DUE!&quot;);
</code></pre>
<h2 id="net-api">.NET API</h2>
<p>The provided API mirrors DUE Script's <a href="../due-script/corelib/corelib.html">Core library</a>. Referencing those APIs is a good place to learn about the available functionality and available arguments.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">.NET API</th>
<th style="text-align: left;">DUE Script Equivalent</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Analog.Read()</td>
<td style="text-align: left;"><a href="../due-script/corelib/analog.html">ARead()</a></td>
<td>Reads analog pin</td>
</tr>
<tr>
<td style="text-align: left;">Analog.Write()</td>
<td style="text-align: left;"><a href="../due-script/corelib/analog.html">AWrite()</a></td>
<td>Reads analog pin</td>
</tr>
<tr>
<td style="text-align: left;">Button.Enable()</td>
<td style="text-align: left;"><a href="../due-script/corelib/button.html">BtnEnable()</a></td>
<td>Sets up a button to be used</td>
</tr>
<tr>
<td style="text-align: left;">Button.JustPressed()</td>
<td style="text-align: left;"><a href="../due-script/corelib/button.html">BtnDown()</a></td>
<td>Detects if button was pressed</td>
</tr>
<tr>
<td style="text-align: left;">Button.JustReleased()</td>
<td style="text-align: left;"><a href="../due-script/corelib/button.html">BtnDown()</a></td>
<td>Detects if button is released</td>
</tr>
<tr>
<td style="text-align: left;">DeviceConfig.IsEdge()</td>
<td style="text-align: left;"><a href="../due-script/corelib/systemfunctions.html">Version()</a></td>
<td>Checks for specific hardware</td>
</tr>
<tr>
<td style="text-align: left;">DeviceConfig.IsFlea()</td>
<td style="text-align: left;"><a href="../due-script/corelib/systemfunctions.html">Version()</a></td>
<td>Checks for specific hardware</td>
</tr>
<tr>
<td style="text-align: left;">DeviceConfig.IsPico()</td>
<td style="text-align: left;"><a href="../due-script/corelib/systemfunctions.html">Version()</a></td>
<td>Checks for specific hardware</td>
</tr>
<tr>
<td style="text-align: left;">DeviceConfig.IsPulse()</td>
<td style="text-align: left;"><a href="../due-script/corelib/systemfunctions.html">Version()</a></td>
<td>Checks for specific hardware</td>
</tr>
<tr>
<td style="text-align: left;">DeviceConfig.MaxPinIO()</td>
<td style="text-align: left;">NA</td>
<td>Returns # available GPIOs</td>
</tr>
<tr>
<td style="text-align: left;">DeviceConfig.MaxPinAnalog()</td>
<td style="text-align: left;">NA</td>
<td>Returns # available Analog pins</td>
</tr>
<tr>
<td style="text-align: left;">Digital.Read()</td>
<td style="text-align: left;"><a href="../due-script/corelib/digital.html">DRead()</a></td>
<td>Reads digital pin</td>
</tr>
<tr>
<td style="text-align: left;">Digital.Write()</td>
<td style="text-align: left;"><a href="../due-script/corelib/digital.html">DWrite()</a></td>
<td>Writes to digital pin</td>
</tr>
<tr>
<td style="text-align: left;">Display.Clear()</td>
<td style="text-align: left;"><a href="../due-script/corelib/lcd.html">LcdClear()</a></td>
<td>Clears the display black or white</td>
</tr>
<tr>
<td style="text-align: left;">Display.Configuration()</td>
<td style="text-align: left;"><a href="../due-script/corelib/lcd.html">LcdConfig()</a></td>
<td>Set display configuration</td>
</tr>
<tr>
<td style="text-align: left;">Display.DrawBuffer()</td>
<td style="text-align: left;"><a href="../due-script/corelib/lcd.html">LcdStream()</a></td>
<td>Updates the entire display, takes an array, using stream, with automatic Show()</td>
</tr>
<tr>
<td style="text-align: left;">Display.DrawBufferBytes()</td>
<td style="text-align: left;"><a href="../due-script/corelib/lcd.html">LcdStream()</a></td>
<td>Updates the entire display, takes bytes, using stream, with automatic Show()</td>
</tr>
<tr>
<td style="text-align: left;">Display.DrawCircle()</td>
<td style="text-align: left;"><a href="../due-script/corelib/lcd.html">LcdCircle()</a></td>
<td>Draws a circle on the display</td>
</tr>
<tr>
<td style="text-align: left;">Display.DrawFillRect()</td>
<td style="text-align: left;"><a href="../due-script/corelib/lcd.html">LcdFill()</a></td>
<td>Draws a filled rectangle on the display</td>
</tr>
<tr>
<td style="text-align: left;">Display.DrawImage()</td>
<td style="text-align: left;"><a href="../due-script/corelib/lcd.html">LcdImg()</a></td>
<td>Draws an image using an array</td>
</tr>
<tr>
<td style="text-align: left;">Display.DrawImageBytes()</td>
<td style="text-align: left;"><a href="../due-script/corelib/lcd.html">LcdImg()</a></td>
<td>Draws an image using bytes</td>
</tr>
<tr>
<td style="text-align: left;">Display.DrawImageScale()</td>
<td style="text-align: left;"><a href="../due-script/corelib/lcd.html">LcdImg()</a></td>
<td>Works same as DrawImage() adds scaling</td>
</tr>
<tr>
<td style="text-align: left;">Display.DrawLine()</td>
<td style="text-align: left;"><a href="../due-script/corelib/lcd.html">LcdLine()</a></td>
<td>Draws a line on the display</td>
</tr>
<tr>
<td style="text-align: left;">Display.DrawRectangle()</td>
<td style="text-align: left;"><a href="../due-script/corelib/lcd.html">LcdRect()</a></td>
<td>Draws a rectangle on the display</td>
</tr>
<tr>
<td style="text-align: left;">Display.DrawText()</td>
<td style="text-align: left;"><a href="../due-script/corelib/lcd.html">LcdText()</a></td>
<td>Draws a text on the display</td>
</tr>
<tr>
<td style="text-align: left;">Display.DrawTextScale()</td>
<td style="text-align: left;"><a href="../due-script/corelib/lcd.html">LcdTextS()</a></td>
<td>Draws scaled text on the display</td>
</tr>
<tr>
<td style="text-align: left;">Display.SetPixel()</td>
<td style="text-align: left;"><a href="../due-script/corelib/lcd.html">LcdPixel()</a></td>
<td>Draws pixel on the display</td>
</tr>
<tr>
<td style="text-align: left;">Display.Show()</td>
<td style="text-align: left;"><a href="../due-script/corelib/lcd.html">LcdShow()</a></td>
<td>Sends the display buffer</td>
</tr>
<tr>
<td style="text-align: left;">Distance.Read()</td>
<td style="text-align: left;"><a href="../due-script/corelib/distance.html">Distance()</a></td>
<td>Used to read distance sensors</td>
</tr>
<tr>
<td style="text-align: left;">Frequency.Write()</td>
<td style="text-align: left;"><a href="../due-script/corelib/frequency.html">Freq()</a></td>
<td>Hardware generated PWM signal</td>
</tr>
<tr>
<td style="text-align: left;">I2c.Write()</td>
<td style="text-align: left;"><a href="../due-script/corelib/i2c.html">I2cStream()</a></td>
<td>I2C write, using stream</td>
</tr>
<tr>
<td style="text-align: left;">I2c.Read()</td>
<td style="text-align: left;"><a href="../due-script/corelib/i2c.html">I2cStream()</a></td>
<td>I2C read, using stream</td>
</tr>
<tr>
<td style="text-align: left;">I2c.WriteRead()</td>
<td style="text-align: left;"><a href="../due-script/corelib/i2c.html">I2cStream()</a></td>
<td>I2C write/read, using stream</td>
</tr>
<tr>
<td style="text-align: left;">Infrared.Enable()</td>
<td style="text-align: left;"><a href="../due-script/corelib/infrared.html">IrEnable()</a></td>
<td>Enables pin for IR signal capture</td>
</tr>
<tr>
<td style="text-align: left;">Infrared.Read()</td>
<td style="text-align: left;"><a href="../due-script/corelib/infrared.html">IrRead()</a></td>
<td>Reads value from IR enabled pin</td>
</tr>
<tr>
<td style="text-align: left;">Led.Set()</td>
<td style="text-align: left;"><a href="../due-script/corelib/led.html">LED()</a></td>
<td>Controls the on-board LED</td>
</tr>
<tr>
<td style="text-align: left;">Neo.Clear()</td>
<td style="text-align: left;"><a href="../due-script/corelib/neopixel.html">NeoClear()</a></td>
<td>Clears all LED's in memory</td>
</tr>
<tr>
<td style="text-align: left;">Neo.SetColor()</td>
<td style="text-align: left;"><a href="../due-script/corelib/neopixel.html">NeoSet()</a></td>
<td>Set's a specific LED to a color</td>
</tr>
<tr>
<td style="text-align: left;">Neo.Show()</td>
<td style="text-align: left;"><a href="../due-script/corelib/neopixel.html">NeoShow()</a></td>
<td>Transfers the internal pattern to LEDs</td>
</tr>
<tr>
<td style="text-align: left;">Neo.SetMultiple()</td>
<td style="text-align: left;"><a href="../due-script/corelib/neopixel.html">NeoStream()</a></td>
<td>Updates all LEDs, using streams, with automatic <code>Show()</code></td>
</tr>
<tr>
<td style="text-align: left;">Led.Set()</td>
<td style="text-align: left;"><a href="../due-script/corelib/led.html">LED()</a></td>
<td>Controls the on-board LED</td>
</tr>
<tr>
<td style="text-align: left;">Servo.Set()</td>
<td style="text-align: left;"><a href="../due-script/corelib/servo.html">ServoSet()</a></td>
<td>Sets servo motor connected to a pin</td>
</tr>
<tr>
<td style="text-align: left;">Spi.Configuration()</td>
<td style="text-align: left;"><a href="../due-script/corelib/spi.html">SpiCfg()</a></td>
<td>Configures SPI bus</td>
</tr>
<tr>
<td style="text-align: left;">Spi.Palette()</td>
<td style="text-align: left;"><a href="../due-script/corelib/spi.html">Palette()</a></td>
<td>Sets the desired color for a palette</td>
</tr>
<tr>
<td style="text-align: left;">Spi.Read()</td>
<td style="text-align: left;"><a href="../due-script/corelib/spi.html">SpiByte()</a></td>
<td>Reads SPI byte</td>
</tr>
<tr>
<td style="text-align: left;">Spi.Write()</td>
<td style="text-align: left;"><a href="../due-script/corelib/spi.html">SpiByte()</a></td>
<td>Sends SPI byte</td>
</tr>
<tr>
<td style="text-align: left;">Spi.Write4bpp()</td>
<td style="text-align: left;"><a href="../due-script/corelib/spi.html">Spi4Bpp()</a></td>
<td>Streams and converts data from 4BPP to 16BPP</td>
</tr>
<tr>
<td style="text-align: left;">Spi.WriteRead()</td>
<td style="text-align: left;"><a href="../due-script/corelib/spi.html">SpiStream()</a></td>
<td>Write &amp; Read SPI bytes</td>
</tr>
<tr>
<td style="text-align: left;">System.Beep()</td>
<td style="text-align: left;"><a href="../due-script/corelib/beep.html">Beep()</a></td>
<td>Uses any pin to generate a tone</td>
</tr>
<tr>
<td style="text-align: left;">System.GetTickMicroseconds()</td>
<td style="text-align: left;"><a href="../due-script/corelib/systemfunctions.html">TickUs()</a></td>
<td>Returns system time in microseconds</td>
</tr>
<tr>
<td style="text-align: left;">System.GetTickMilliseconds()</td>
<td style="text-align: left;"><a href="../due-script/corelib/systemfunctions.html">TickMs()</a></td>
<td>Returns system time in milliseconds</td>
</tr>
<tr>
<td style="text-align: left;">System.Print()</td>
<td style="text-align: left;"><a href="../due-script/corelib/systemfunctions.html">Print()</a></td>
<td>Print to LCD display and Debug Output on the same line</td>
</tr>
<tr>
<td style="text-align: left;">System.PrintLn()</td>
<td style="text-align: left;"><a href="../due-script/corelib/systemfunctions.html">PrintLn()</a></td>
<td>Print to LCD display and Debug Output then moves to next line</td>
</tr>
<tr>
<td style="text-align: left;">System.Reset()</td>
<td style="text-align: left;"><a href="../due-script/corelib/systemfunctions.html">Reset()</a></td>
<td>Resets the board</td>
</tr>
<tr>
<td style="text-align: left;">System.Wait()</td>
<td style="text-align: left;"><a href="../due-script/corelib/systemfunctions.html">Wait()</a></td>
<td>Pause the system in milliseconds</td>
</tr>
<tr>
<td style="text-align: left;">Touch.Read()</td>
<td style="text-align: left;"><a href="../due-script/corelib/touch.html">TouchRead()</a></td>
<td>Initialize a pin for touch</td>
</tr>
<tr>
<td style="text-align: left;">Uart.BytesToRead()</td>
<td style="text-align: left;"><a href="../due-script/corelib/uart.html">UartCount()</a></td>
<td>How many bytes buffered and ready to read</td>
</tr>
<tr>
<td style="text-align: left;">Uart.Enable()</td>
<td style="text-align: left;"><a href="../due-script/corelib/uart.html">UartInit()</a></td>
<td>Initialize UART</td>
</tr>
<tr>
<td style="text-align: left;">Uart.Read()</td>
<td style="text-align: left;"><a href="../due-script/corelib/uart.html">UartRead()</a></td>
<td>Read UART data</td>
</tr>
<tr>
<td style="text-align: left;">Uart.Write()</td>
<td style="text-align: left;"><a href="../due-script/corelib/uart.html">UartWrite()</a></td>
<td>Write UART data</td>
</tr>
<tr>
<td style="text-align: left;">Version()</td>
<td style="text-align: left;"><a href="../due-script/corelib/systemfunctions.html">Version()</a></td>
<td>Returns the current DUE firmware version</td>
</tr>
</tbody>
</table>
<div class="NOTE">
<h5>Note</h5>
<p>For convenience, the Pin Enum includes, ButtonA, ButtonB and Led. For example: <code>dev.Digital.Write(dev.Pin.Led, True)</code></p>
</div>
<h2 id="due-script-control">DUE Script Control</h2>
<p>These methods allow developers to control DUE Scripts right from within .NET</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Script.Execute()</td>
<td style="text-align: left;">Executes the single line of code immediately</td>
</tr>
<tr>
<td style="text-align: left;">Script.IsRunning()</td>
<td style="text-align: left;">Checks if DUE Script is running</td>
</tr>
<tr>
<td style="text-align: left;">Script.Load()</td>
<td style="text-align: left;">Loads the line into internal buffer</td>
</tr>
<tr>
<td style="text-align: left;">Script.New()</td>
<td style="text-align: left;">Clears the program stored in flash</td>
</tr>
<tr>
<td style="text-align: left;">Script.Read()</td>
<td style="text-align: left;">Read the program stored in flash and return as string</td>
</tr>
<tr>
<td style="text-align: left;">Script.Record()</td>
<td style="text-align: left;">Sends the internal buffer to the device, overwriting any previous programs</td>
</tr>
<tr>
<td style="text-align: left;">Script.Run()</td>
<td style="text-align: left;">Runs the program stored in flash</td>
</tr>
</tbody>
</table>
<p>This example will load a simple program line by line and then record it.</p>
<pre><code class="lang-csharp">dev.Script.Load(&quot;c = 10&quot;);
dev.Script.Load(&quot;@Blink&quot;);
dev.Script.Load(&quot;Led(100,100,c)&quot;);
dev.Script.Record();
</code></pre>
<p>This is an example to execute a single line(immediate mode). This does not modify the application stored in flash.</p>
<pre><code class="lang-csharp">dev.Script.Execute(&quot;LED(200,200,10)&quot;);
</code></pre>
<p>You can also access a previously recorder program using goto (to label) or by calling a function that has a return. This example calls the recorded program above.</p>
<pre><code class="lang-csharp">dev.Script.Execute(&quot;c=5:goto Blink&quot;);
</code></pre>

</article>

        <div class="contribution d-print-none">
          <a href="https://github.com/ghi-electronics/duelink-website/blob/duelink_v1.1.5/software/coding-options/dotnet.md/#L1" class="edit-link">Edit this page</a>
        </div>

        <div class="next-article d-print-none border-top" id="nextArticle"></div>

      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Copyright © 2024 GHI Electronics, LLC<br>Generated by DocFX</span>
        </div>
      </div>
    </footer>
  </body>
</html>
